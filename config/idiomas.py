"""
Sistema de tradu√ß√£o DEFINITIVO para Amaro Aviation
Simples, robusto, sempre funciona
"""

# TRADU√á√ïES COMPLETAS E DEFINITIVAS
TRANSLATIONS = {
    'pt': {
        # Interface Principal
        'app_title': 'Amaro Aviation',
        'app_subtitle': 'Simulador Estrat√©gico de Custos',
        'language': 'Idioma / Language',
        'welcome_message': 'Bem-vindo ao simulador de custos operacionais mais completo do mercado',
        
        # P√°ginas
        'page_profit': 'Estimativa de Lucro',
        'page_breakdown': 'Breakdown de Custos',
        'page_simulator': 'Simulador de Rotas',
        'page_projection': 'Proje√ß√£o e Breakeven',
        'page_settings': 'Configura√ß√µes',
        
        # Campos Comuns
        'aircraft_model': 'Modelo da Aeronave',
        'flight_hours': 'Horas de Voo',
        'calculate': 'Calcular',
        'export': 'Exportar',
        'save': 'Salvar',
        'cancel': 'Cancelar',
        'loading': 'Carregando...',
        'error': 'Erro',
        'success': 'Sucesso',
        'warning': 'Aten√ß√£o',
        'info': 'Informa√ß√£o',
        
        # Estimativa de Lucro
        'monthly_hours': 'Horas de Charter/m√™s',
        'occupancy_rate': 'Taxa de Ocupa√ß√£o (%)',
        'charter_price': 'Pre√ßo Hora Charter (R$)',
        'gross_revenue': 'Receita Bruta Mensal',
        'owner_revenue': 'Receita do Propriet√°rio (90%)',
        'net_profit': 'Lucro L√≠quido',
        'monthly_roi': 'ROI Mensal',
        'revenue_composition': 'Composi√ß√£o de Receitas',
        'cost_breakdown': 'Breakdown de Custos Operacionais',
        'profitable_operation': 'Opera√ß√£o Lucrativa',
        'operation_deficit': 'Opera√ß√£o com D√©ficit',
        
        # Simulador de Rotas
        'origin_airport': 'Aeroporto de Origem',
        'destination_airport': 'Aeroporto de Destino',
        'simulate_route': 'Simular Rota',
        'route_analysis': 'An√°lise da Rota',
        'flight_duration': 'Dura√ß√£o do Voo',
        'total_cost_amaro': 'Custo Total Amaro',
        'market_price': 'Pre√ßo de Mercado',
        'savings': 'Economia',
        'cost_composition': 'Composi√ß√£o de Custos',
        'visual_comparison': 'Comparativo Visual',
        'advantageous_route': 'Rota Vantajosa',
        'route_attention': 'Aten√ß√£o',
        
        # Breakdown de Custos
        'annual_hours': 'Horas de Voo Anuais',
        'own_management': 'Gest√£o Pr√≥pria',
        'amaro_management': 'Gest√£o Amaro',
        'annual_savings': 'Economia Anual',
        'cost_reduction': 'de redu√ß√£o de custos',
        'detailed_breakdown': 'Breakdown Detalhado',
        'hangar': 'Hangaragem',
        'insurance': 'Seguro',
        'crew': 'Tripula√ß√£o',
        'administration': 'Administra√ß√£o',
        'fuel': 'Combust√≠vel',
        'maintenance': 'Manuten√ß√£o',
        'depreciation': 'Deprecia√ß√£o',
        
        # Proje√ß√£o 
        'projection_horizon': 'Horizonte de Proje√ß√£o (meses)',
        'growth_rate': 'Taxa de Crescimento (%)',
        'generate_projection': 'Gerar Proje√ß√£o',
        'projection_analysis': 'An√°lise de Proje√ß√£o',
        'breakeven': 'Breakeven',
        'months': 'Meses',
        'value_currency': 'Valor (R$)',
        
        # Configura√ß√µes
        'financial_parameters': 'Par√¢metros Financeiros',
        'aircraft_models': 'Modelos de Aeronaves',
        'available_routes': 'Rotas Dispon√≠veis',
        'fuel_price': 'Pre√ßo do Combust√≠vel (R$/litro)',
        'pilot_cost': 'Custo Hora Piloto (R$)',
        'model': 'Modelo',
        'consumption': 'Consumo (L/h)',
        'origin': 'Origem',
        'destination': 'Destino',
        'duration': 'Dura√ß√£o (h)',
        'config_saved': 'Configura√ß√£o salva com sucesso!',
        
        # Status
        'system_ok': 'Sistema funcionando corretamente',
        'system_error': 'Erro no sistema',
        'no_data': 'Nenhum dado dispon√≠vel',
        'invalid_data': 'Dados inv√°lidos'
    },
    
    'en': {
        # Main Interface
        'app_title': 'Amaro Aviation',
        'app_subtitle': 'Strategic Cost Simulator',
        'language': 'Language / Idioma',
        'welcome_message': 'Welcome to the most complete operational cost simulator in the market',
        
        # Pages
        'page_profit': 'Profit Estimation',
        'page_breakdown': 'Cost Breakdown',
        'page_simulator': 'Route Simulator',
        'page_projection': 'Projection and Breakeven',
        'page_settings': 'Settings',
        
        # Common Fields
        'aircraft_model': 'Aircraft Model',
        'flight_hours': 'Flight Hours',
        'calculate': 'Calculate',
        'export': 'Export',
        'save': 'Save',
        'cancel': 'Cancel',
        'loading': 'Loading...',
        'error': 'Error',
        'success': 'Success',
        'warning': 'Warning',
        'info': 'Information',
        
        # Profit Estimation
        'monthly_hours': 'Charter Hours/month',
        'occupancy_rate': 'Occupancy Rate (%)',
        'charter_price': 'Charter Hour Price (R$)',
        'gross_revenue': 'Monthly Gross Revenue',
        'owner_revenue': 'Owner Revenue (90%)',
        'net_profit': 'Net Profit',
        'monthly_roi': 'Monthly ROI',
        'revenue_composition': 'Revenue Composition',
        'cost_breakdown': 'Operational Cost Breakdown',
        'profitable_operation': 'Profitable Operation',
        'operation_deficit': 'Operation with Deficit',
        
        # Route Simulator
        'origin_airport': 'Origin Airport',
        'destination_airport': 'Destination Airport',
        'simulate_route': 'Simulate Route',
        'route_analysis': 'Route Analysis',
        'flight_duration': 'Flight Duration',
        'total_cost_amaro': 'Total Amaro Cost',
        'market_price': 'Market Price',
        'savings': 'Savings',
        'cost_composition': 'Cost Composition',
        'visual_comparison': 'Visual Comparison',
        'advantageous_route': 'Advantageous Route',
        'route_attention': 'Attention',
        
        # Cost Breakdown
        'annual_hours': 'Annual Flight Hours',
        'own_management': 'Own Management',
        'amaro_management': 'Amaro Management',
        'annual_savings': 'Annual Savings',
        'cost_reduction': 'cost reduction',
        'detailed_breakdown': 'Detailed Breakdown',
        'hangar': 'Hangar',
        'insurance': 'Insurance',
        'crew': 'Crew',
        'administration': 'Administration',
        'fuel': 'Fuel',
        'maintenance': 'Maintenance',
        'depreciation': 'Depreciation',
        
        # Projection
        'projection_horizon': 'Projection Horizon (months)',
        'growth_rate': 'Growth Rate (%)',
        'generate_projection': 'Generate Projection',
        'projection_analysis': 'Projection Analysis',
        'breakeven': 'Breakeven',
        'months': 'Months',
        'value_currency': 'Value (R$)',
        
        # Settings
        'financial_parameters': 'Financial Parameters',
        'aircraft_models': 'Aircraft Models',
        'available_routes': 'Available Routes',
        'fuel_price': 'Fuel Price (R$/liter)',
        'pilot_cost': 'Pilot Hour Cost (R$)',
        'model': 'Model',
        'consumption': 'Consumption (L/h)',
        'origin': 'Origin',
        'destination': 'Destination',
        'duration': 'Duration (h)',
        'config_saved': 'Settings saved successfully!',
        
        # Status
        'system_ok': 'System working correctly',
        'system_error': 'System error',
        'no_data': 'No data available',
        'invalid_data': 'Invalid data'
    }
}

def get_text(key, lang='pt'):
    """
    Fun√ß√£o DEFINITIVA de tradu√ß√£o
    SEMPRE retorna algo v√°lido, nunca quebra
    """
    try:
        # Verificar se o idioma existe
        if lang not in TRANSLATIONS:
            lang = 'pt'  # Fallback para portugu√™s
        
        # Verificar se a chave existe no idioma
        if key in TRANSLATIONS[lang]:
            return TRANSLATIONS[lang][key]
        
        # Fallback para portugu√™s se n√£o existe no idioma
        if key in TRANSLATIONS['pt']:
            return TRANSLATIONS['pt'][key]
        
        # √öltimo fallback: retornar a chave formatada
        return key.replace('_', ' ').title()
        
    except Exception:
        # Se tudo falhar, retornar chave formatada
        return str(key).replace('_', ' ').title()

def t(key, lang='pt'):
    """Fun√ß√£o de conveni√™ncia para tradu√ß√£o"""
    return get_text(key, lang)

def detect_language_from_selection(selection):
    """
    Detecta idioma baseado na sele√ß√£o do selectbox
    SEMPRE retorna um idioma v√°lido
    """
    try:
        if isinstance(selection, str):
            if 'üáßüá∑' in selection or 'Portugu√™s' in selection:
                return 'pt'
            elif 'üá∫üá∏' in selection or 'English' in selection:
                return 'en'
        
        # Fallback padr√£o
        return 'pt'
        
    except Exception:
        return 'pt'

def get_language_options():
    """Retorna op√ß√µes de idioma para selectbox"""
    return ["üáßüá∑ Portugu√™s", "üá∫üá∏ English"]

def get_current_language_display(lang):
    """Retorna o display atual do idioma selecionado"""
    if lang == 'en':
        return "üá∫üá∏ English"
    else:
        return "üáßüá∑ Portugu√™s"

def validate_translations():
    """Valida se todas as tradu√ß√µes est√£o completas"""
    pt_keys = set(TRANSLATIONS['pt'].keys())
    en_keys = set(TRANSLATIONS['en'].keys())
    
    missing_pt = en_keys - pt_keys
    missing_en = pt_keys - en_keys
    
    if missing_pt:
        print(f"‚ö†Ô∏è  Chaves ausentes em PT: {missing_pt}")
    
    if missing_en:
        print(f"‚ö†Ô∏è  Chaves ausentes em EN: {missing_en}")
    
    if not missing_pt and not missing_en:
        print("‚úÖ Todas as tradu√ß√µes est√£o completas!")
    
    return len(missing_pt) == 0 and len(missing_en) == 0

# Fun√ß√£o de teste
def test_translations():
    """Testa se o sistema de tradu√ß√£o funciona"""
    print("üß™ Testando sistema de tradu√ß√µes...")
    
    # Testar chaves v√°lidas
    assert get_text('app_title', 'pt') == 'Amaro Aviation'
    assert get_text('app_title', 'en') == 'Amaro Aviation'
    assert get_text('page_profit', 'pt') == 'Estimativa de Lucro'
    assert get_text('page_profit', 'en') == 'Profit Estimation'
    
    # Testar chaves inexistentes
    assert get_text('chave_inexistente', 'pt') == 'Chave Inexistente'
    
    # Testar idioma inexistente
    assert get_text('app_title', 'fr') == 'Amaro Aviation'  # Fallback para PT
    
    # Testar detec√ß√£o de idioma
    assert detect_language_from_selection('üáßüá∑ Portugu√™s') == 'pt'
    assert detect_language_from_selection('üá∫üá∏ English') == 'en'
    assert detect_language_from_selection('Qualquer coisa') == 'pt'  # Fallback
    
    print("‚úÖ Sistema de tradu√ß√µes funcionando perfeitamente!")

# Executar valida√ß√£o se rodado diretamente
if __name__ == "__main__":
    validate_translations()
    test_translations()